<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Steel Surge - FTC Robotics Team</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap');
    
    :root {
      --primary: #38bdf8;
      --primary-dark: #0ea5e9;
      --primary-glow: rgba(56, 189, 248, 0.5);
      --accent: #7c3aed;
      --accent-glow: rgba(124, 58, 237, 0.5);
      --dark-bg: #030711;
      --card-bg: rgba(17, 24, 39, 0.7);
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --nav-bg: rgba(3, 7, 18, 0.8);
    }
    [data-theme="light"] {
      --primary: #0ea5e9;
      --primary-dark: #38bdf8;
      --primary-glow: rgba(56, 189, 248, 0.18);
      --accent: #7c3aed;
      --accent-glow: rgba(124, 58, 237, 0.13);
      --dark-bg: #f1f5f9;
      --card-bg: #fff;
      --text-primary: #030711;
      --text-secondary: #334155;
      --nav-bg: #e0e7ef;
    }
    
    /* Add these CSS rules for section visibility */
    .content section {
      display: none !important;  /* Hide all sections by default */
    }
    
    .content section.active-section {
      display: block !important;  /* Show only active section */
    }
    
    html {
      scroll-behavior: smooth;
    }
    
    body {
      background-color: var(--dark-bg);
      color: var(--text-primary);
      font-family: 'Rajdhani', sans-serif;
      overflow-x: hidden;
      min-height: 100vh;
      position: relative;
    }
    
    h1, h2, h3, h4, h5, h6, nav {
      font-family: 'Orbitron', sans-serif;
    }
    
    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
    }
    
    nav {
      background-color: var(--nav-bg);
      backdrop-filter: blur(12px);
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      box-shadow: 0 4px 20px -5px rgba(56, 189, 248, 0.3);
      border-bottom: 1px solid rgba(56, 189, 248, 0.2);
    }
    
    nav h1 {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--primary);
      text-shadow: 0 0 10px var(--primary-glow);
      position: relative;
      overflow: hidden;
    }
    
    nav h1::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 2px;
      bottom: -2px;
      left: 0;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
      animation: navGlow 3s infinite;
    }
    
    @keyframes navGlow {
      0%, 100% { opacity: 0.3; transform: translateX(-100%); }
      50% { opacity: 1; transform: translateX(100%); }
    }
    
    nav .links {
      display: flex;
      gap: 1.5rem;
    }
    
    nav .links a {
      font-size: 0.9rem;
      font-weight: 600;
      text-transform: uppercase;
      color: var(--text-primary);
      text-decoration: none;
      padding: 0.5rem 0.75rem;
      border-radius: 4px;
      letter-spacing: 1px;
      position: relative;
      transition: all 0.3s ease;
    }
    
    nav .links a::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 2px;
      background: var(--primary);
      transform: translateX(-50%);
      transition: width 0.3s ease;
    }
    
    nav .links a:hover {
      color: var(--primary);
      text-shadow: 0 0 8px var(--primary-glow);
    }
    
    nav .links a:hover::before {
      width: 80%;
    }
    
    .content {
      padding-top: 7rem;
      padding-left: 2.5rem;
      padding-right: 2.5rem;
      max-width: 80rem;
      margin: 0 auto;
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 3rem;
    }
    
    .content section {
      background: linear-gradient(120deg, rgba(17,24,39,0.92) 60%, rgba(56,189,248,0.07) 100%);
      border-radius: 1.5rem;
      box-shadow: 0 8px 32px 0 rgba(56,189,248,0.10), 0 1.5px 8px 0 rgba(124,58,237,0.08);
      padding: 2.5rem 2rem 2.5rem 2rem;
      margin-bottom: 0;
      border: 1.5px solid rgba(56,189,248,0.13);
      transition: box-shadow 0.3s, border 0.3s;
      display: none !important;
    }
    
    .content section.active-section {
      display: block !important;
      animation: fadeInUp 0.8s cubic-bezier(0.23,1,0.32,1) both;
    }
    
    .section-header {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin-bottom: 2.5rem;
      margin-top: 0.5rem;
      border-bottom: 1.5px solid rgba(56,189,248,0.13);
      padding-bottom: 1.2rem;
    }
    
    section h2 {
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--primary);
      letter-spacing: 1.5px;
      margin-bottom: 0;
      text-shadow: 0 0 12px var(--primary-glow);
    }
    
    section h2::after {
      content: '';
      display: block;
      margin-top: 0.7rem;
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      border-radius: 3px;
    }
    
    .card {
      background: linear-gradient(120deg, var(--card-bg) 80%, var(--primary-glow) 100%);
      border-radius: 1.2rem;
      box-shadow: 0 4px 24px 0 rgba(56,189,248,0.10), 0 1.5px 8px 0 rgba(124,58,237,0.08);
      border: 1.5px solid rgba(56,189,248,0.13);
      padding: 2rem 1.5rem;
      margin-bottom: 0;
      transition: box-shadow 0.3s, border 0.3s, transform 0.2s;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      align-items: flex-start;
    }
    
    .card:hover {
      box-shadow: 0 8px 32px 0 rgba(56,189,248,0.18), 0 1.5px 8px 0 rgba(124,58,237,0.13);
      border-color: var(--primary);
      transform: translateY(-4px) scale(1.012);
    }
    
    .card h3 {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary);
      margin-bottom: 0.5rem;
      text-shadow: 0 0 8px var(--primary-glow);
    }
    
    .card p {
      color: var(--text-secondary);
      line-height: 1.7;
      font-size: 1.08rem;
    }
    
    .card button, .back-btn, .achievement-card {
      font-family: 'Orbitron', sans-serif;
      font-weight: 700;
      letter-spacing: 1px;
      border-radius: 0.7rem;
      box-shadow: 0 2px 8px var(--primary-glow);
      transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.15s;
    }
    
    .card button:hover, .back-btn:hover {
      background: var(--primary-dark);
      color: #fff;
      box-shadow: 0 4px 16px var(--primary-glow);
      transform: scale(1.04);
    }
    
    .grid, .sponsors-grid {
      display: grid;
      gap: 2.2rem;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      margin-bottom: 0;
    }
    
    .sponsors-grid {
      gap: 1.5rem;
    }
    
    .achievement-card {
      background: linear-gradient(90deg, rgba(56,189,248,0.10), rgba(124,58,237,0.10));
      border: 2px solid #334155;
      border-radius: 1rem;
      padding: 1.2rem;
      display: flex;
      align-items: center;
      gap: 1.2rem;
      opacity: 0.95;
      margin-bottom: 0.7rem;
      font-size: 1.1rem;
    }
    
    .achievement-card[style*='rgba(56,189,248,0.15)'] {
      border: 2px solid #38bdf8;
      opacity: 1;
    }
    
    /* Responsive tweaks */
    @media (max-width: 900px) {
      .content {
        padding-left: 1rem;
        padding-right: 1rem;
      }
      .grid, .sponsors-grid {
        grid-template-columns: 1fr;
      }
      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.7rem;
      }
    }
    
    .lightning-overlay {
      pointer-events: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 5;
      overflow: hidden;
    }
    
    .lightning-bolt {
      position: absolute;
      opacity: 0;
      top: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      filter: brightness(1.10) contrast(1.05); /* less intense */
      mix-blend-mode: screen;
      will-change: opacity, filter;
    }
    
    .bolt-1 {
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNNjUsMTAgTDIwLDkwIEwzNSw1MCBMMTUsNTUgTDYwLDEwIEw0NSw1MCBMODUsNDUgTDY1LDEwIFoiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPjwvc3ZnPg==') no-repeat center center;
      animation: flashBolt 18s infinite;
      animation-delay: 2s;
    }
    
    .bolt-2 {
      background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNNDAsMTUgTDg1LDkwIEw2MCw1MCBMODAsNDUgTDM1LDEwIEw2MCw2MCBMMjAsNDUgTDQwLDE1IFoiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMSIvPjwvc3ZnPg==') no-repeat center center;
      animation: flashBolt 22s infinite;
      animation-delay: 7s;
    }
    
    .lightning-effect {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(to right, rgba(30, 58, 138, 0.03), rgba(59, 130, 246, 0.06), transparent);
      animation: ambientGlow 14s infinite alternate;
      mix-blend-mode: screen;
    }
    
    @keyframes ambientGlow {
      0%, 100% { opacity: 0.13; background-position: 0% 50%; }
      50% { opacity: 0.22; background-position: 100% 50%; }
    }
    
    @keyframes flashBolt {
      0%, 97% { opacity: 0; filter: brightness(1.10) blur(0px); }
      98%, 98.5% { opacity: 0.25; filter: brightness(1.13) blur(0.5px); }
      98.6%, 99% { opacity: 0.15; filter: brightness(1.08) blur(1px); }
      99.1%, 100% { opacity: 0; filter: brightness(1.05) blur(1.5px); }
    }
    
    .card {
      background-color: var(--card-bg);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(56, 189, 248, 0.2);
      border-radius: 0.75rem;
      box-shadow: 
        0 20px 25px -5px rgba(0, 0, 0, 0.3),
        0 0 10px rgba(56, 189, 248, 0.2);
      transition: all 0.4s ease;
      padding: 1.75rem;
      margin-bottom: 1.5rem;
      overflow: hidden;
      position: relative;
    }
    
    .card::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: all 0.7s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 
        0 25px 50px -12px rgba(0, 0, 0, 0.5),
        0 0 15px rgba(56, 189, 248, 0.4);
      border-color: rgba(56, 189, 248, 0.4);
    }
    
    .card:hover::after {
      left: 100%;
    }
    
    .card h3 {
      font-size: 1.35rem;
      font-weight: bold;
      color: var(--primary);
      margin-bottom: 0.75rem;
      position: relative;
      display: inline-block;
    }
    
    .card h3::before {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 40px;
      height: 2px;
      background: var(--primary);
    }
    
    .card p {
      color: var(--text-secondary);
      line-height: 1.6;
    }
    
    .home-section, .about-section, .sponsors-section, .media-section, .blog-section {
      display: none;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    
    .active-section {
      display: block;
      opacity: 1;
      transform: translateY(0);
      animation: fadeInUp 0.8s ease forwards;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    section h2 {
      position: relative;
      display: inline-block;
      margin-bottom: 1.5rem;
    }
    
    section h2::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 0;
      width: 60px;
      height: 3px;
      background: var(--primary);
      border-radius: 3px;
    }
    
    .robot-container {
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 2;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    .robot {
      position: absolute;
      bottom: 0;
      left: 0;
      z-index: 2;
      filter: drop-shadow(0 0 15px rgba(56, 189, 248, 0.5));
      transition: transform 10s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    .sponsors-grid img {
      filter: grayscale(80%);
      opacity: 0.7;
      transition: all 0.3s ease;
    }
    
    .sponsors-grid img:hover {
      filter: grayscale(0%);
      opacity: 1;
      transform: scale(1.05);
    }
    
    /* Responsive styles */
    @media (max-width: 768px) {
      nav .links {
        gap: 0.5rem;
      }
      nav .links a {
        font-size: 0.75rem;
        padding: 0.3rem 0.5rem;
      }
      #nav-links {
        max-height: 0;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }
    }
    @media (min-width: 769px) {
      #nav-links {
        max-height: none !important;
        overflow: visible !important;
        display: flex !important;
        flex-direction: row !important;
      }
    }
    /* Accessibility Toolbar - always top right, above all content, visible in all themes */
    #accessibility-toolbar {
      position: fixed;
      top: 50%;
      right: 0;
      transform: translateY(-50%);
      z-index: 99999;
      background: var(--nav-bg, #222);
      border: 2px solid var(--primary, #38bdf8);
      border-radius: 1.5rem 0 0 1.5rem;
      padding: 0.7rem 1.2rem 0.7rem 1.4rem;
      box-shadow: 0 2px 8px var(--primary-glow, #38bdf8);
      display: flex;
      align-items: center;
      gap: 1.2rem;
      min-width: 160px;
      max-width: 90vw;
      color: var(--text-primary, #fff);
      margin-right: 0;
    }
    #accessibility-toolbar button {
      color: var(--text-primary, #fff);
    }
    @media (max-width: 600px) {
      #accessibility-toolbar {
        top: 60%;
        right: 0;
        transform: translateY(-50%);
        padding: 0.5rem 0.7rem 0.5rem 1rem;
        font-size: 0.95rem;
        min-width: 120px;
      }
    }
  </style>
</head>
<body>
  <noscript><div style="background:#f87171;color:#fff;padding:1rem;text-align:center;font-size:1.2rem;z-index:99999;position:fixed;top:0;left:0;width:100vw;">This site requires JavaScript to function properly. Please enable JavaScript in your browser.</div></noscript>
  <div id="accessibility-toolbar">
    <span style="color:var(--primary);font-weight:bold;">Accessibility:</span>
    <button id="theme-toggle" aria-label="Toggle light/dark mode" style="background:none;border:none;color:var(--text-primary);font-size:1.3rem;cursor:pointer;">🌙</button>
  </div>
  <div id="particles-js"></div>
  <div class="lightning-overlay">
    <div class="lightning-effect"></div>
    <div class="lightning-bolt bolt-1"></div>
    <div class="lightning-bolt bolt-2"></div>
  </div>
  <div id="robot-container" class="robot-container" style="display:none;"></div>
  <nav>
    <h1>Steel Surge</h1>
    <button id="nav-toggle" aria-label="Open navigation" class="md:hidden" style="background:none;border:none;color:var(--primary);font-size:2rem;cursor:pointer;position:absolute;right:1.5rem;top:1.2rem;z-index:101;">☰</button>
    <div class="links" id="nav-links" style="transition:max-height 0.4s;overflow:hidden;">
      <a href="#" data-section="home">Home</a>
      <a href="#" data-section="about">About</a>
      <a href="#" data-section="sponsors">Sponsors</a>
      <a href="#" data-section="media">Media</a>
      <a href="#" data-section="blog">Blog</a>
      <a href="#" data-section="games">Games</a>
      <a href="#" data-section="achievements">Achievements</a>
      <a href="#" data-section="pit">Pit Tour</a>
      <a href="#" data-section="strategy">Strategy</a>
      <a href="#" data-section="challenges">Challenges</a>
      <a href="#" data-section="mentors">Mentors</a>
      <a href="#" data-section="dashboard">Dashboard</a>
    </div>
  </nav>
  
  <div class="content">
    <section id="home" class="home-section active-section">
      <div class="text-center">
        <h2 class="text-4xl sm:text-5xl md:text-6xl font-bold text-sky-300 mb-6 animate__animated animate__fadeIn">Welcome to Steel Surge</h2>
        <p class="text-gray-300 text-xl max-w-2xl mx-auto animate__animated animate__fadeIn animate__delay-1s">An FTC Robotics team from Unionville-Chadds Ford School District pushing the boundaries of innovation.</p>
      </div>
    </section>
    
    <section id="about" class="about-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">About Us</h2>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-6">
        <div class="card">
          <h3>Our Team</h3>
          <p>We are a 7-person team founded in 2024. Our mission is to design, build, and compete with innovative robotics systems while supporting STEM outreach in our community.</p>
        </div>
        <div class="card">
          <h3>Our Vision</h3>
          <p>Building tomorrow's engineers through today's challenges. We strive to innovate, learn, and inspire others through competitive robotics.</p>
        </div>
      </div>
    </section>
    
    <section id="sponsors" class="sponsors-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Sponsors</h2>
      </div>
      <p class="text-gray-300 mb-8">Thank you to our sponsors who help make our journey possible!</p>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6 sponsors-grid">
        <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Sponsor 1" class="rounded-lg hover:shadow-glow transition-all duration-300">
        <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Sponsor 2" class="rounded-lg hover:shadow-glow transition-all duration-300">
        <img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80" alt="Sponsor 3" class="rounded-lg hover:shadow-glow transition-all duration-300">
        <img src="https://images.unsplash.com/photo-1521737852567-6949f3f9f2b5?auto=format&fit=crop&w=400&q=80" alt="Sponsor 4" class="rounded-lg hover:shadow-glow transition-all duration-300">
      </div>
    </section>
    
    <section id="media" class="media-section">
      <h2 class="text-3xl md:text-4xl font-bold text-sky-300">Media</h2>
      <p class="text-gray-300 mb-8">Videos and social links</p>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 border border-sky-700/30">
          <iframe class="w-full h-72" src="https://www.youtube.com/embed/samplevideo" title="YouTube" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
        <div class="rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 border border-sky-700/30">
          <iframe class="w-full h-72" src="https://snapwidget.com/embed/sample" title="Instagram" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
      </div>
    </section>
    
    <section id="blog" class="blog-section">
      <h2 class="text-3xl md:text-4xl font-bold text-sky-300">Blog</h2>
      <div class="space-y-6 mt-6">
        <div class="card">
          <h3>Kickoff Day</h3>
          <p>We kicked off the new FTC season with a full team brainstorm and strategy session! The energy was high as we dissected this year's game challenge and began mapping our approach to robot design.</p>
        </div>
        <div class="card">
          <h3>Build Week 1</h3>
          <p>Initial drivetrain testing is underway. We're excited to try our new gear configuration, which should provide better torque for climbing obstacles while maintaining speed for scoring elements.</p>
        </div>
      </div>
    </section>
    <section id="games" class="games-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Games</h2>
      </div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-6">
        <!-- Surge Maze Game Card -->
        <div class="card" style="align-items:center;text-align:center;">
          <div style="font-size:3rem;">🔩</div>
          <h3>Surge Maze</h3>
          <p>Guide Surge through a high-graphic maze, collect bolts, and avoid bugs!</p>
          <button onclick="launchGame('surge-maze')" style="background:#38bdf8;color:#030711;font-weight:bold;font-size:1.1rem;padding:0.6rem 2rem;border:none;border-radius:0.7rem;cursor:pointer;box-shadow:0 2px 8px #38bdf8;">Play Surge Maze</button>
        </div>
        <!-- Pac-Man Game Card -->
        <div class="card" style="align-items:center;text-align:center;">
          <div style="font-size:3rem;">
            <svg width="48" height="48" viewBox="0 0 48 48"><circle cx="24" cy="24" r="22" fill="#fbbf24" stroke="#222" stroke-width="2"/><path d="M24 8a16 16 0 1 0 0 32c3.5 0 6.7-1 9.3-2.7L24 24V8z" fill="#fff"/><circle cx="32" cy="16" r="3" fill="#222"/></svg>
          </div>
          <h3>Pac-Man: Surge Edition</h3>
          <p>Play a high-def, original Pac-Man style game with a Steel Surge twist!</p>
          <button onclick="launchGame('pacman')" style="background:#fbbf24;color:#222;font-weight:bold;font-size:1.1rem;padding:0.6rem 2rem;border:none;border-radius:0.7rem;cursor:pointer;box-shadow:0 2px 8px #fbbf24;">Play Pac-Man</button>
        </div>
        <!-- Robot Builder Game Card -->
        <div class="card" style="align-items:center;text-align:center;">
          <div style="font-size:3rem;">
            <svg width="48" height="48" viewBox="0 0 48 48"><rect x="10" y="20" width="28" height="16" rx="4" fill="#7c3aed" stroke="#fff" stroke-width="2"/><rect x="16" y="8" width="16" height="12" rx="3" fill="#38bdf8" stroke="#fff" stroke-width="2"/><circle cx="16" cy="40" r="4" fill="#0ea5e9" stroke="#fff" stroke-width="2"/><circle cx="32" cy="40" r="4" fill="#0ea5e9" stroke="#fff" stroke-width="2"/></svg>
          </div>
          <h3>Robot Builder</h3>
          <p>Design and assemble your own robot in this interactive, high-graphic builder game. Share your creation!</p>
          <button onclick="launchGame('robot-builder')" style="background:#7c3aed;color:#fff;font-weight:bold;font-size:1.1rem;padding:0.6rem 2rem;border:none;border-radius:0.7rem;cursor:pointer;box-shadow:0 2px 8px #7c3aed;">Play Robot Builder</button>
        </div>
        <!-- Memory Circuit Game Card -->
        <div class="card" style="align-items:center;text-align:center;">
          <div style="font-size:3rem;">
            <svg width="48" height="48" viewBox="0 0 48 48"><rect x="8" y="8" width="32" height="32" rx="8" fill="#0ea5e9" stroke="#fff" stroke-width="2"/><rect x="16" y="16" width="16" height="16" rx="4" fill="#fff" stroke="#7c3aed" stroke-width="2"/><circle cx="24" cy="24" r="4" fill="#7c3aed"/></svg>
          </div>
          <h3>Memory Circuit</h3>
          <p>Test your memory and speed in this original, high-graphic circuit-matching game!</p>
          <button onclick="launchGame('memory-circuit')" style="background:#0ea5e9;color:#fff;font-weight:bold;font-size:1.1rem;padding:0.6rem 2rem;border:none;border-radius:0.7rem;cursor:pointer;box-shadow:0 2px 8px #0ea5e9;">Play Memory Circuit</button>
        </div>
      </div>
    </section>
    <section id="achievements" class="achievements-section">
      <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;">
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Achievements</h2>
        <label style="display:flex;align-items:center;gap:0.5rem;font-size:1.1rem;color:#38bdf8;cursor:pointer;">
          <input type="checkbox" id="achievements-toggle" style="accent-color:#38bdf8;width:1.2rem;height:1.2rem;" checked>
          Enable Achievements
        </label>
      </div>
      <div id="achievements-list" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mt-6"></div>
    </section>
    <section id="pit" class="pit-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300 mb-0" style="margin-bottom:0;">Virtual Pit Tour</h2>
      </div>
      <p class="text-gray-300 text-lg mb-6 max-w-2xl mx-auto">Explore our pit area and the current FTC field! Click on any hotspot to learn more about our robot, field elements, and team stations. This tour updates every season with official FTC info.</p>
      <div id="pit-tour-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 mb-8">
        <div class="pit-card" tabindex="0" aria-label="Robot" style="background:rgba(30,41,59,0.85);border-radius:1rem;padding:1.5rem;box-shadow:0 2px 12px #38bdf8;transition:transform 0.2s;cursor:pointer;">
          <h3 class="text-xl font-bold text-sky-300 mb-2">Our Robot</h3>
          <img src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?auto=format&fit=crop&w=400&q=80" alt="Robot" class="rounded mb-2" style="width:100%;max-width:180px;object-fit:cover;"/>
          <p class="text-gray-200 text-sm">See the latest design, features, and competition highlights for this season's robot.</p>
        </div>
        <div class="pit-card" tabindex="0" aria-label="Field Element" style="background:rgba(30,41,59,0.85);border-radius:1rem;padding:1.5rem;box-shadow:0 2px 12px #38bdf8;transition:transform 0.2s;cursor:pointer;">
          <h3 class="text-xl font-bold text-sky-300 mb-2">Field Element</h3>
          <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80" alt="Field Element" class="rounded mb-2" style="width:100%;max-width:180px;object-fit:cover;"/>
          <p class="text-gray-200 text-sm">Learn about the main scoring element or challenge for this season, with official FTC info.</p>
        </div>
        <div class="pit-card" tabindex="0" aria-label="Team Station" style="background:rgba(30,41,59,0.85);border-radius:1rem;padding:1.5rem;box-shadow:0 2px 12px #38bdf8;transition:transform 0.2s;cursor:pointer;">
          <h3 class="text-xl font-bold text-sky-300 mb-2">Team Station</h3>
          <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=400&q=80" alt="Team Station" class="rounded mb-2" style="width:100%;max-width:180px;object-fit:cover;"/>
          <p class="text-gray-200 text-sm">See where our team works, programs, and strategizes during competitions.</p>
        </div>
        <!-- Add more cards/hotspots as needed for each season -->
      </div>
      <div class="text-center text-gray-400 text-sm">Updated for the current FTC season. For more details, see the <a href="https://www.firstinspires.org/robotics/ftc" target="_blank" class="text-sky-300 underline">official FTC game page</a>.</div>
    </section>
    <section id="strategy" class="strategy-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Strategy Simulator</h2>
      </div>
      <div class="card">
        <h3>FTC Game Strategy Simulator</h3>
        <p>Plan your match strategy! Visualize scoring, test different robot roles, and optimize your alliance's path to victory. (Coming soon!)</p>
      </div>
    </section>
    <section id="challenges" class="challenges-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Challenges</h2>
      </div>
      <div class="card">
        <h3>Weekly Build Challenges</h3>
        <p>Try our design, coding, and teamwork challenges. New challenges are posted every week during the season!</p>
      </div>
      <div class="card">
        <h3>Community STEM Challenges</h3>
        <p>Participate in outreach and STEM events for bonus achievements and recognition.</p>
      </div>
    </section>
    <section id="mentors" class="mentors-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Mentor Wall</h2>
      </div>
      <div class="card">
        <h3>Meet Our Mentors</h3>
        <ul style="color:#f1f5f9;list-style:disc;padding-left:1.5rem;">
          <li>Jane Doe – Mechanical Engineering</li>
          <li>John Smith – Programming & Controls</li>
          <li>Alex Lee – Outreach & Strategy</li>
        </ul>
      </div>
    </section>
    <section id="dashboard" class="dashboard-section">
      <div class="section-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:2rem;margin-top:0.5rem;">
        <button class="back-btn" aria-label="Back to Home" onclick="navigateBack()" tabindex="0" style="background:rgba(30,41,59,0.9);color:#38bdf8;border:none;border-radius:0.7rem;padding:0.5rem 1.2rem;font-size:1rem;box-shadow:0 2px 8px #38bdf8;cursor:pointer;z-index:10;">← Back</button>
        <h2 class="text-3xl md:text-4xl font-bold text-sky-300" style="margin-bottom:0;">Team Dashboard</h2>
      </div>
      <div class="card">
        <h3>Team Stats</h3>
        <ul style="color:#f1f5f9;list-style:disc;padding-left:1.5rem;">
          <li>Current Season: 2024-2025</li>
          <li>Events Attended: 3</li>
          <li>Matches Played: 12</li>
          <li>Outreach Hours: 40+</li>
        </ul>
      </div>
      <div class="card">
        <h3>Quick Links</h3>
        <ul style="color:#f1f5f9;list-style:disc;padding-left:1.5rem;">
          <li><a href="https://www.firstinspires.org/robotics/ftc" target="_blank" style="color:#38bdf8;text-decoration:underline;">FTC Official Site</a></li>
          <li><a href="#" style="color:#38bdf8;text-decoration:underline;">Team Calendar</a></li>
          <li><a href="#" style="color:#38bdf8;text-decoration:underline;">Contact Us</a></li>
        </ul>
      </div>
    </section>
  </div>
  
  <script>
    // Particles.js configuration
    document.addEventListener('DOMContentLoaded', () => {
      let particleSize = 3; // Ensure particleSize is defined
      particlesJS('particles-js', {
        "particles": {
          "number": {
            "value": 80,
            "density": {
              "enable": true,
              "value_area": 800
            }
          },
          "color": {
            "value": "#38bdf8"
          },
          "shape": {
            "type": "circle",
            "stroke": {
              "width": 0,
              "color": "#000000"
            },
            "polygon": {
              "nb_sides": 5
            }
          },
          "opacity": {
            "value": 0.4,
            "random": true,
            "anim": {
              "enable": true,
              "speed": 1,
              "opacity_min": 0.1,
              "sync": false
            }
          },
          "size": {
            "value": particleSize,
            "random": true,
            "anim": {
              "enable": true,
              "speed": 2,
              "size_min": 0.1,
              "sync": false
            }
          },
          "line_linked": {
            "enable": true,
            "distance": 150,
            "color": "#38bdf8",
            "opacity": 0.2,
            "width": 1
          },
          "move": {
            "enable": true,
            "speed": 0.8,
            "direction": "none",
            "random": true,
            "straight": false,
            "out_mode": "out",
            "bounce": false,
            "attract": {
              "enable": false,
              "rotateX": 600,
              "rotateY": 1200
            }
          }
        },
        "interactivity": {
          "detect_on": "canvas",
          "events": {
            "onhover": {
              "enable": true,
              "mode": "grab"
            },
            "onclick": {
              "enable": true,
              "mode": "push"
            },
            "resize": true
          },
          "modes": {
            "grab": {
              "distance": 140,
              "line_linked": {
                "opacity": 0.5
              }
            },
            "push": {
              "particles_nb": 3
            }
          }
        },
        "retina_detect": true
      });
    });
    
    // Thunder audio effect
    function setupThunderAudio() {
    const audio = new Audio('https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae7c7.mp3');
      function playThunder() {
      audio.currentTime = 0;
        audio.volume = 0.6;
        audio.play().catch(err => console.log('Audio play failed:', err));
        // Fire lightningStrike event for robot power-up
        const evt = new Event('lightningStrike');
        window.dispatchEvent(evt);
      }
      setInterval(() => {
      if (Math.random() < 0.3) playThunder();
      }, 12000);
    }
    
    // Advanced robot animation
    function createRobot() {
      const robotContainer = document.getElementById('robot-container');
      const robot = document.createElement('div');
      robot.className = 'robot';
      robot.style.position = 'fixed';
      robot.style.right = '32px';
      robot.style.bottom = '32px';
      robot.style.zIndex = '9999';
      robot.style.cursor = 'pointer';
      robot.style.pointerEvents = 'auto';
      robot.style.willChange = 'transform, filter';
      robotContainer.style.pointerEvents = 'none'; // container is transparent to pointer
      robotContainer.appendChild(robot);

      // Facial expressions
      const expressions = [
        {
          name: 'smile',
          mouth: '<path d="M68 62 Q80 78 92 62" stroke="#fff" stroke-width="3" fill="none" stroke-linecap="round"/>',
          leftEye: '<path d="M62 44 Q65 48 68 44" stroke="black" stroke-width="2.2" fill="none" stroke-linecap="round" />',
          rightEye: '<path d="M92 44 Q95 48 98 44" stroke="black" stroke-width="2.2" fill="none" stroke-linecap="round" />',
          blush: true
        },
        {
          name: 'open',
          mouth: '<ellipse cx="80" cy="65" rx="8" ry="6" fill="#fff" stroke="#fff" stroke-width="2"/>',
          leftEye: '<ellipse cx="65" cy="45" rx="5" ry="7" fill="black" />',
          rightEye: '<ellipse cx="95" cy="45" rx="5" ry="7" fill="black" />',
          blush: false
        },
        {
          name: 'neutral',
          mouth: '<line x1="72" y1="65" x2="88" y2="65" stroke="#fff" stroke-width="3" stroke-linecap="round"/>',
          leftEye: '<ellipse cx="65" cy="45" rx="5" ry="5" fill="black" />',
          rightEye: '<ellipse cx="95" cy="45" rx="5" ry="5" fill="black" />',
          blush: false
        },
        {
          name: 'wink',
          mouth: '<path d="M68 62 Q80 78 92 62" stroke="#fff" stroke-width="3" fill="none" stroke-linecap="round"/>',
          leftEye: '<path d="M62 44 Q65 48 68 44" stroke="black" stroke-width="2.2" fill="none" stroke-linecap="round" />',
          rightEye: '<ellipse cx="95" cy="45" rx="5" ry="5" fill="black" />',
          blush: true
        },
        {
          name: 'surprised',
          mouth: '<ellipse cx="80" cy="65" rx="4" ry="7" fill="#fff" stroke="#fff" stroke-width="2"/>',
          leftEye: '<ellipse cx="65" cy="45" rx="6" ry="6" fill="black" />',
          rightEye: '<ellipse cx="95" cy="45" rx="6" ry="6" fill="black" />',
          blush: false
        },
        // New expressions
        {
          name: 'excited',
          mouth: '<path d="M70 62 Q80 85 90 62" stroke="#fff" stroke-width="3" fill="none" stroke-linecap="round"/>',
          leftEye: '<ellipse cx="65" cy="45" rx="6" ry="6" fill="#7c3aed" />',
          rightEye: '<ellipse cx="95" cy="45" rx="6" ry="6" fill="#7c3aed" />',
          blush: true
        },
        {
          name: 'thinking',
          mouth: '<ellipse cx="80" cy="68" rx="6" ry="2" fill="#fff" stroke="#fff" stroke-width="2"/>',
          leftEye: '<ellipse cx="63" cy="45" rx="4" ry="4" fill="black" />',
          rightEye: '<ellipse cx="97" cy="45" rx="4" ry="4" fill="black" />',
          blush: false
        }
      ];
      let currentExpression = 0;
      window.surgeClickCount = window.surgeClickCount || 0;
      window.surgePacmanShown = window.surgePacmanShown || false;
      let poweredUp = false;

      function getFaceSVG(expr) {
        return `
          ${expr.leftEye}
          <circle cx="65" cy="45" r="2" fill="#7c3aed" filter="url(#glow)" />
          ${expr.rightEye}
          <circle cx="95" cy="45" r="2" fill="#7c3aed" filter="url(#glow)" />
          ${expr.mouth}
          ${expr.blush ? '<ellipse cx="60" cy="58" rx="4" ry="2" fill="#fca5a5" opacity="0.5" /><ellipse cx="100" cy="58" rx="4" ry="2" fill="#fca5a5" opacity="0.5" />' : ''}
        `;
      }

      function renderRobotFace(exprIdx) {
        const expr = expressions[exprIdx];
        // Remove all children except the speech bubble (if present)
        const bubble = robot.querySelector('.speech-bubble');
        robot.innerHTML = '';
        const svg = document.createElement('div');
        svg.innerHTML = `
        <svg viewBox="0 0 160 140" width="120" height="120">
          <defs>
            <linearGradient id="robotBody" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#f0f9ff" />
              <stop offset="100%" stop-color="#38bdf8" />
            </linearGradient>
            <linearGradient id="robotHead" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#f0f9ff" />
              <stop offset="100%" stop-color="#0ea5e9" />
            </linearGradient>
            <filter id="glow">
              <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>
              <feMerge>
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          <rect x="30" y="60" width="100" height="60" rx="12" fill="url(#robotBody)" stroke="#f0f9ff" stroke-width="1.5" filter="url(#glow)" />
          <rect x="45" y="65" width="70" height="5" rx="2" fill="rgba(255,255,255,0.3)" />
          <rect x="45" y="75" width="70" height="2" rx="1" fill="rgba(255,255,255,0.2)" />
          <rect x="55" y="83" width="50" height="3" rx="1.5" fill="rgba(255,255,255,0.25)" />
          <rect x="60" y="105" width="40" height="8" rx="4" fill="rgba(0,0,0,0.3)" />
          <rect x="50" y="30" width="60" height="30" rx="8" fill="url(#robotHead)" stroke="#f0f9ff" stroke-width="1.5" filter="url(#glow)" />
          <circle cx="50" cy="125" r="10" fill="#1e3a8a" stroke="#f0f9ff" stroke-width="1" />
          <circle cx="70" cy="125" r="10" fill="#1e3a8a" stroke="#f0f9ff" stroke-width="1" />
          <circle cx="90" cy="125" r="10" fill="#1e3a8a" stroke="#f0f9ff" stroke-width="1" />
          <circle cx="110" cy="125" r="10" fill="#1e3a8a" stroke="#f0f9ff" stroke-width="1" />
          <circle cx="50" cy="125" r="4" fill="#0f172a" />
          <circle cx="70" cy="125" r="4" fill="#0f172a" />
          <circle cx="90" cy="125" r="4" fill="#0f172a" />
          <circle cx="110" cy="125" r="4" fill="#0f172a" />
          ${getFaceSVG(expr)}
          <line x1="60" y1="30" x2="55" y2="15" stroke="#f0f9ff" stroke-width="2" />
          <circle cx="55" cy="15" r="2" fill="#7c3aed" filter="url(#glow)" />
          <line x1="100" y1="30" x2="105" y2="15" stroke="#f0f9ff" stroke-width="2" />
          <circle cx="105" cy="15" r="2" fill="#7c3aed" filter="url(#glow)" />
        </svg>
        `;
        robot.appendChild(svg.firstElementChild);
        if (bubble) robot.appendChild(bubble);
      }

      renderRobotFace(currentExpression);

      // Speech bubble
      let speechBubble = document.createElement('div');
      speechBubble.className = 'speech-bubble';
      speechBubble.style.position = 'absolute';
      speechBubble.style.right = '130px';
      speechBubble.style.bottom = '80px';
      speechBubble.style.background = 'rgba(30,41,59,0.97)';
      speechBubble.style.color = '#f0f9ff';
      speechBubble.style.padding = '0.7rem 1.2rem';
      speechBubble.style.borderRadius = '1rem';
      speechBubble.style.fontFamily = 'Rajdhani, sans-serif';
      speechBubble.style.fontSize = '1.1rem';
      speechBubble.style.boxShadow = '0 2px 8px #38bdf8';
      speechBubble.style.zIndex = '10001';
      speechBubble.style.opacity = '0.97';
      speechBubble.style.pointerEvents = 'none';
      speechBubble.style.transition = 'opacity 0.4s';
      speechBubble.innerHTML = 'Hi! I\'m Surge!';
      robot.appendChild(speechBubble);
      // Each message is paired with an expression index
      const messages = [
        { text: "Hi! I'm Surge, your Steel Surge teammate!", expression: 0 }, // smile
        { text: "Steel Surge: Building tomorrow's engineers!", expression: 4 }, // excited
        { text: "Did you know? Our robot is designed and built by students!", expression: 1 }, // open
        { text: "FTC is all about teamwork, creativity, and innovation.", expression: 2 }, // neutral
        { text: "We love solving real-world problems with robotics!", expression: 4 }, // excited
        { text: "Unionville-Chadds Ford—home of Steel Surge!", expression: 0 }, // smile
        { text: "Our mission: Inspire, innovate, and compete.", expression: 4 }, // excited
        { text: "Ask me about our outreach and STEM events!", expression: 1 }, // open
        { text: "Every part on our robot has a purpose.", expression: 5 }, // thinking
        { text: "Keep pushing boundaries—just like Steel Surge!", expression: 4 }, // excited
        { text: "Robotics is more than building—it's learning and growing.", expression: 2 }, // neutral
        { text: "Go Steel Surge! Proud to be FTC Team 2024!", expression: 4 }, // excited
        { text: "Curious about our robot? Click me for a surprise!", expression: 3 }, // wink
      ];
      let msgIdx = 0;
      let messageInterval = null;
      let randomExpressionAllowed = true;
      function setMessageAndExpression(idx) {
        msgIdx = idx % messages.length;
        speechBubble.innerHTML = messages[msgIdx].text;
        currentExpression = messages[msgIdx].expression;
        renderRobotFace(currentExpression);
        randomExpressionAllowed = false;
        setTimeout(() => { randomExpressionAllowed = true; }, 3500);
      }
      setMessageAndExpression(0);
      messageInterval = setInterval(() => {
        setMessageAndExpression(msgIdx + 1);
      }, 6000);

      // Powered up animation
      function powerUpRobot() {
        if (poweredUp) return;
        poweredUp = true;
        robot.style.filter = 'drop-shadow(0 0 40px #38bdf8) brightness(1.3)';
        robot.style.transform = 'scale(1.08) rotate(-3deg)';
        speechBubble.innerHTML = "I'm powered up! ⚡";
        setTimeout(() => {
          robot.style.filter = '';
          robot.style.transform = '';
          poweredUp = false;
        }, 1800);
      }

      // Listen for lightning events
      window.addEventListener('lightningStrike', powerUpRobot);

      // Smoother idle animation (gentle floating)
      function animateRobotFloat() {
        robot.animate([
          { transform: 'translateY(0px) scale(1)' },
          { transform: 'translateY(-8px) scale(1.01)' },
          { transform: 'translateY(0px) scale(1)' },
          { transform: 'translateY(6px) scale(0.99)' },
          { transform: 'translateY(0px) scale(1)' }
        ], {
          duration: 4200,
          iterations: Infinity
        });
      }
      animateRobotFloat();

      // Random expression changes
      setInterval(() => {
        if (!poweredUp && randomExpressionAllowed && Math.random() < 0.25) {
          let next;
          do {
            next = Math.floor(Math.random() * expressions.length);
          } while (next === currentExpression);
          currentExpression = next;
          renderRobotFace(currentExpression);
        }
      }, 7000);

      // Occasional background event: shooting star
      function spawnShootingStar() {
        const star = document.createElement('div');
        star.style.position = 'fixed';
        star.style.top = Math.random() * 40 + 10 + 'vh';
        star.style.left = '-60px';
        star.style.width = '60px';
        star.style.height = '3px';
        star.style.background = 'linear-gradient(90deg, #fff 0%, #38bdf8 100%)';
        star.style.opacity = '0.8';
        star.style.borderRadius = '2px';
        star.style.zIndex = '100';
        star.style.pointerEvents = 'none';
        document.body.appendChild(star);
        const anim = star.animate([
          { left: '-60px', opacity: 0.8 },
          { left: '110vw', opacity: 0.1 }
        ], {
          duration: 1800 + Math.random() * 1200,
          easing: 'ease-in',
        });
        anim.onfinish = () => star.remove();
        setTimeout(() => star.remove(), 2500);
      }
      // Adjust shooting star interval for low-power devices
      let shootingStarInterval = 6000;
      if (navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 2) {
        shootingStarInterval = 12000;
      }
      setInterval(() => {
        if (Math.random() < 0.18) spawnShootingStar();
      }, shootingStarInterval);

      // Interactive particles: follow mouse
      document.addEventListener('mousemove', (e) => {
        if(window.pJSDom&&window.pJSDom[0]){
          const pJS = window.pJSDom[0].pJS;
          if(pJS && pJS.particles && pJS.particles.move){
            pJS.interactivity.mouse.pos_x = e.clientX;
            pJS.interactivity.mouse.pos_y = e.clientY;
          }
        }
      });

      // User interaction: click or hover to change expression
      function changeExpressionRandom() {
        let next;
        do {
          next = Math.floor(Math.random() * expressions.length);
        } while (next === currentExpression);
        currentExpression = next;
        renderRobotFace(currentExpression);
      }
      robot.addEventListener('mouseenter', () => {
        currentExpression = 3; // wink
        renderRobotFace(currentExpression);
      });
      robot.addEventListener('mouseleave', () => {
        currentExpression = 0; // smile
        renderRobotFace(currentExpression);
      });

      // Pac-Man modal
      function showPacmanModal() {
        const modal = document.createElement('div');
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100vw';
        modal.style.height = '100vh';
        modal.style.background = 'rgba(10,20,40,0.85)';
        modal.style.zIndex = '10000';
        modal.style.display = 'flex';
        modal.style.flexDirection = 'column';
        modal.style.alignItems = 'center';
        modal.style.justifyContent = 'center';
        modal.innerHTML = `
          <div style="background:rgba(30,41,59,0.95);padding:2rem 2.5rem;border-radius:1.5rem;box-shadow:0 8px 32px #000;display:flex;flex-direction:column;align-items:center;">
            <h2 style="color:#38bdf8;font-size:2rem;font-family:'Orbitron',sans-serif;margin-bottom:1rem;">Mini Game Unlocked!</h2>
            <p style="color:#fff;margin-bottom:1.5rem;">You clicked the robot 10 times!<br>Play a Pac-Man style game?</p>
            <button id="play-pacman-btn" style="background:#38bdf8;color:#030711;font-weight:bold;font-size:1.2rem;padding:0.7rem 2.2rem;border:none;border-radius:0.7rem;cursor:pointer;box-shadow:0 2px 8px #38bdf8;">Play Pac-Man</button>
            <button id="close-pacman-btn" style="margin-top:1.2rem;background:#222;color:#fff;font-size:1rem;padding:0.5rem 1.5rem;border:none;border-radius:0.5rem;cursor:pointer;">Close</button>
            <div id="pacman-canvas-container" style="margin-top:2rem;display:none;"></div>
      </div>
        `;
        document.body.appendChild(modal);
        document.getElementById('close-pacman-btn').onclick = () => modal.remove();
        document.getElementById('play-pacman-btn').onclick = () => {
          document.getElementById('pacman-canvas-container').style.display = 'block';
          document.getElementById('play-pacman-btn').style.display = 'none';
          try {
            if (typeof startPacmanGameHD === 'function') {
              console.log('[DEBUG] Calling startPacmanGameHD for Pac-Man modal');
              startPacmanGameHD(document.getElementById('pacman-canvas-container'));
            } else {
              console.error('[ERROR] startPacmanGameHD is not defined!');
            }
          } catch (e) {
            console.error('[ERROR] Exception in startPacmanGameHD:', e);
          }
        };
      }

      // Attach a single click event to the robot-container for event delegation (inside createRobot)
      robot.addEventListener('click', (e) => {
        window.surgeClickCount++;
        if (!window.surgePacmanShown && window.surgeClickCount >= 10) {
          showPacmanModal();
          window.surgePacmanShown = true;
          unlockAchievement('tenClicks');
        } else {
          changeExpressionRandom();
          if (window.surgeClickCount === 1) unlockAchievement('firstClick');
        }
      });
    }

    // Move startPacmanGameHD to global scope
    function startPacmanGameHD(container) {
      // Responsive Surge Maze Game with accessibility and smooth animation
      container.innerHTML = `<canvas id="surge-maze-canvas" tabindex="0" aria-label="Surge Maze Game" style="background:#030711;border-radius:1rem;box-shadow:0 0 24px #38bdf8;width:100%;max-width:600px;max-height:80vw;outline:none;"></canvas>
      <div id="surge-maze-ui" style="color:#fff;text-align:center;margin-top:1rem;"></div>`;
      const canvas = container.querySelector('#surge-maze-canvas');
      const ctx = canvas.getContext('2d');
      // Responsive sizing
      function resizeCanvas() {
        let w = Math.min(600, window.innerWidth * 0.95);
        let h = Math.min(500, window.innerHeight * 0.7);
        canvas.width = w;
        canvas.height = h;
      }
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);
      // Maze layout: 0=empty, 1=wall, 2=bolt
      const maze = [
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
        [1,2,0,0,0,1,0,2,0,1,0,2,0,1,0,0,0,0,2,1],
        [1,0,1,1,0,1,0,1,0,1,0,1,0,1,0,1,1,0,0,1],
        [1,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1],
        [1,0,1,0,1,1,0,1,1,1,0,1,1,1,0,1,1,0,0,1],
        [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,2,1],
        [1,1,1,1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,1,1],
        [1,2,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,2,1],
        [1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],
        [1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1],
        [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
      ];
      let cellSize = Math.min(canvas.width/maze[0].length, canvas.height/maze.length);
      let player = {x:1, y:1, dx:0, dy:0, nextDx:0, nextDy:0, alive:true, score:0};
      let bolts = [];
      let bugs = [
        {x:18, y:9, dx:0, dy:-1, color:'#f87171', mode:'chase'},
        {x:1, y:9, dx:1, dy:0, color:'#fbbf24', mode:'chase'}
      ];
      // Collect all bolt positions
      for(let y=0;y<maze.length;y++) for(let x=0;x<maze[0].length;x++) if(maze[y][x]===2) bolts.push({x,y});
      function drawMaze() {
        for(let y=0;y<maze.length;y++) for(let x=0;x<maze[0].length;x++) {
          if(maze[y][x]===1) {
            ctx.fillStyle = '#0ea5e9';
            ctx.fillRect(x*cellSize, y*cellSize, cellSize, cellSize);
          }
        }
      }
      function drawBolts() {
        for(const b of bolts) {
          ctx.save();
          ctx.translate(b.x*cellSize+cellSize/2, b.y*cellSize+cellSize/2);
          ctx.rotate(Date.now()/400 % Math.PI*2);
          ctx.strokeStyle = '#fbbf24';
          ctx.lineWidth = 3;
          ctx.beginPath();
          ctx.moveTo(-6,-6); ctx.lineTo(0,0); ctx.lineTo(-2,0); ctx.lineTo(6,6);
          ctx.stroke();
          ctx.restore();
        }
      }
      function drawSurge(px,py) {
        ctx.save();
        ctx.translate(px*cellSize+cellSize/2, py*cellSize+cellSize/2);
        ctx.beginPath();
        ctx.arc(0,0,cellSize/2-2,0,Math.PI*2);
        ctx.fillStyle = '#38bdf8';
        ctx.shadowColor = '#7c3aed';
        ctx.shadowBlur = 8;
        ctx.fill();
        ctx.beginPath(); ctx.arc(-cellSize/5,-cellSize/6,cellSize/8,0,Math.PI*2); ctx.arc(cellSize/5,-cellSize/6,cellSize/8,0,Math.PI*2); ctx.fillStyle='#fff'; ctx.fill();
        ctx.beginPath(); ctx.arc(-cellSize/5,-cellSize/7,cellSize/20,0,Math.PI); ctx.arc(cellSize/5,-cellSize/7,cellSize/20,0,Math.PI); ctx.strokeStyle='#222'; ctx.lineWidth=cellSize/30; ctx.stroke();
        ctx.beginPath(); ctx.arc(0,cellSize/7,cellSize/4,0,Math.PI,false); ctx.strokeStyle='#fff'; ctx.lineWidth=cellSize/18; ctx.stroke();
        ctx.restore();
      }
      function drawBugs() {
        for(const bug of bugs) {
          ctx.save();
          ctx.translate(bug.x*cellSize+cellSize/2, bug.y*cellSize+cellSize/2);
          ctx.beginPath();
          ctx.arc(0,0,cellSize/2-4,Math.PI,Math.PI*2);
          ctx.lineTo(cellSize/2-4,cellSize/2-4);
          ctx.lineTo(-cellSize/2+4,cellSize/2-4);
          ctx.closePath();
          ctx.fillStyle = bug.color;
          ctx.shadowColor = '#fff';
          ctx.shadowBlur = 4;
          ctx.fill();
          ctx.beginPath(); ctx.arc(-cellSize/4,-cellSize/8,cellSize/10,0,Math.PI*2); ctx.arc(cellSize/4,-cellSize/8,cellSize/10,0,Math.PI*2); ctx.fillStyle='#fff'; ctx.fill();
          ctx.beginPath(); ctx.arc(-cellSize/4,-cellSize/8,cellSize/20,0,Math.PI*2); ctx.arc(cellSize/4,-cellSize/8,cellSize/20,0,Math.PI*2); ctx.fillStyle='#222'; ctx.fill();
          ctx.restore();
        }
      }
      function draw() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        cellSize = Math.min(canvas.width/maze[0].length, canvas.height/maze.length);
        drawMaze();
        drawBolts();
        drawSurge(player.x,player.y);
        drawBugs();
      }
      function canMove(x,y) {
        return maze[y] && maze[y][x]!==1;
      }
      function movePlayer() {
        if (player.nextDx!==player.dx||player.nextDy!==player.dy) {
          if (canMove(player.x+player.nextDx,player.y+player.nextDy)) {
            player.dx=player.nextDx; player.dy=player.nextDy;
          }
        }
        if (canMove(player.x+player.dx,player.y+player.dy)) {
          player.x+=player.dx; player.y+=player.dy;
        }
      }
      function collectBolts() {
        for(let i=0;i<bolts.length;i++) {
          if(bolts[i].x===player.x&&bolts[i].y===player.y) {
            bolts.splice(i,1); player.score+=10; break;
          }
        }
      }
      function moveBugs() {
        for(const bug of bugs) {
          let options = [];
          if(canMove(bug.x+1,bug.y)) options.push({dx:1,dy:0});
          if(canMove(bug.x-1,bug.y)) options.push({dx:-1,dy:0});
          if(canMove(bug.x,bug.y+1)) options.push({dx:0,dy:1});
          if(canMove(bug.x,bug.y-1)) options.push({dx:0,dy:-1});
          options.sort((a,b)=>{
            const da = Math.abs((bug.x+a.dx)-player.x)+Math.abs((bug.y+a.dy)-player.y);
            const db = Math.abs((bug.x+b.dx)-player.x)+Math.abs((bug.y+b.dy)-player.y);
            return da-db;
          });
          if(options.length) {
            bug.x+=options[0].dx; bug.y+=options[0].dy;
          }
        }
      }
      function checkLose() {
        for(const bug of bugs) {
          if(bug.x===player.x&&bug.y===player.y) return true;
        }
        return false;
      }
      function checkWin() {
        return bolts.length===0;
      }
      function updateUI() {
        const ui = container.querySelector('#surge-maze-ui');
        ui.innerHTML = `<b>Score:</b> ${player.score} &nbsp; <b>Bugs:</b> ${bugs.length} &nbsp; <b>Bolts left:</b> ${bolts.length}`;
      }
      let gameOver = false;
      let lastMove = 0;
      function gameLoop(ts) {
        if(gameOver) return;
        if(!lastMove || ts-lastMove>220) {
          movePlayer();
          collectBolts();
          moveBugs();
          lastMove = ts;
        }
        draw();
        updateUI();
        if(checkLose()) {
          gameOver = true;
          showEndScreen(false);
          return;
        }
        if(checkWin()) {
          gameOver = true;
          showEndScreen(true);
          return;
        }
        requestAnimationFrame(gameLoop);
      }
      function showEndScreen(win) {
        const ui = container.querySelector('#surge-maze-ui');
        ui.innerHTML = win ? `<h3 style='color:#38bdf8'>You Win! Surge collected all the bolts!</h3><p>Score: ${player.score}</p>` : `<h3 style='color:#f87171'>Game Over! Surge was caught by a bug!</h3><p>Score: ${player.score}</p>`;
        ui.innerHTML += `<button id='play-again-btn' style='margin:1rem 0.5rem 0 0;background:#38bdf8;color:#030711;font-weight:bold;font-size:1.1rem;padding:0.6rem 2rem;border:none;border-radius:0.7rem;cursor:pointer;'>Play Again</button><button id='close-game-btn' style='margin:1rem 0 0 0.5rem;background:#222;color:#fff;font-size:1.1rem;padding:0.6rem 2rem;border:none;border-radius:0.7rem;cursor:pointer;'>Close</button>`;
        document.getElementById('play-again-btn').onclick = ()=>{startPacmanGameHD(container);};
        document.getElementById('close-game-btn').onclick = ()=>{container.parentElement.parentElement.remove();};
      }
      // Accessibility: focus canvas, keyboard controls
      canvas.focus();
      canvas.setAttribute('role','application');
      canvas.setAttribute('aria-label','Surge Maze Game');
      canvas.addEventListener('keydown',function handler(e){
        if(gameOver) return;
        if(['ArrowUp','w','W'].includes(e.key)) {player.nextDx=0;player.nextDy=-1;}
        else if(['ArrowDown','s','S'].includes(e.key)) {player.nextDx=0;player.nextDy=1;}
        else if(['ArrowLeft','a','A'].includes(e.key)) {player.nextDx=-1;player.nextDy=0;}
        else if(['ArrowRight','d','D'].includes(e.key)) {player.nextDx=1;player.nextDy=0;}
      });
      draw();
      updateUI();
      requestAnimationFrame(gameLoop);
    }

    // Add Pac-Man button
    let pacmanBtn = document.createElement('button');
    pacmanBtn.id = 'pacman-fab';
    pacmanBtn.title = 'Play Pac-Man!';
    pacmanBtn.innerHTML = `<svg width="38" height="38" viewBox="0 0 38 38"><circle cx="19" cy="19" r="19" fill="#fbbf24"/><path d="M19 7a12 12 0 1 0 0 24c2.5 0 4.8-0.7 6.7-2l-6.7-10V7z" fill="#fff"/><circle cx="24" cy="14" r="2" fill="#222"/></svg>`;
    pacmanBtn.style.position = 'fixed';
    pacmanBtn.style.right = '40px';
    pacmanBtn.style.bottom = '170px';
    pacmanBtn.style.zIndex = '10002';
    pacmanBtn.style.background = 'rgba(30,41,59,0.97)';
    pacmanBtn.style.border = 'none';
    pacmanBtn.style.borderRadius = '50%';
    pacmanBtn.style.boxShadow = '0 2px 12px #fbbf24, 0 0 0 4px rgba(251,191,36,0.15)';
    pacmanBtn.style.padding = '0.5rem';
    pacmanBtn.style.cursor = 'pointer';
    pacmanBtn.style.transition = 'transform 0.2s';
    pacmanBtn.onmouseenter = () => pacmanBtn.style.transform = 'scale(1.12)';
    pacmanBtn.onmouseleave = () => pacmanBtn.style.transform = 'scale(1)';
    document.body.appendChild(pacmanBtn);
    pacmanBtn.onclick = (e) => {
      e.stopPropagation();
      showPacmanModal();
    };
  
  
  // Enhanced navigation with transitions and accessibility
  function setupNavigation() {
    const navToggle = document.getElementById('nav-toggle');
    const navLinks = document.getElementById('nav-links');
    const links = navLinks.querySelectorAll('a');

    // Function to switch active section
    function switchSection(sectionId) {
      // Hide all sections
      document.querySelectorAll('.content section').forEach(section => {
        section.classList.remove('active-section');
      });

      // Show target section
      const targetSection = document.getElementById(sectionId);
      if (targetSection) {
        targetSection.classList.add('active-section');
        targetSection.scrollIntoView({behavior: 'smooth', block: 'start'});
      }

      // Update navigation
      links.forEach(link => {
        link.classList.toggle('active', link.getAttribute('data-section') === sectionId);
      });

      // Handle home extras
      if (typeof showHomeExtras === 'function') {
        showHomeExtras(sectionId === 'home');
      }
    }

    // Handle navigation clicks
    links.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const sectionId = link.getAttribute('data-section');
        switchSection(sectionId);
      });
    });

    // Make switchSection available globally
    window.switchSection = switchSection;

    // Global back navigation function
    window.navigateBack = function() {
      switchSection('home');
    };

    // Mobile nav toggle
    navToggle.addEventListener('click', () => {
      const isExpanded = navLinks.style.maxHeight !== '0px' && navLinks.style.maxHeight !== '';
      navLinks.style.maxHeight = isExpanded ? '0px' : navLinks.scrollHeight + 'px';
      navToggle.setAttribute('aria-label', isExpanded ? 'Open navigation' : 'Close navigation');
    });

    // Handle resize
    window.addEventListener('resize', () => {
      navLinks.style.maxHeight = window.innerWidth >= 768 ? '' : '0px';
    });
  }
  
  // Initialize everything when the page loads
  document.addEventListener('DOMContentLoaded', () => {
    setupThunderAudio();
    setupNavigation();
    
    // Show home section initially
    switchSection('home');
    
    // Only show robot and Pac-Man on Home
    function showHomeExtras(show) {
      const robotContainer = document.getElementById('robot-container');
      if (show) {
        robotContainer.style.display = '';
        robotContainer.innerHTML = '';
        createRobot();
      } else {
        robotContainer.style.display = 'none';
        robotContainer.innerHTML = '';
        let pacmanBtn = document.getElementById('pacman-fab');
        if (pacmanBtn) pacmanBtn.remove();
      }
    }
    window.showHomeExtras = showHomeExtras; // Make available globally
    // Initial state: show only home section
    document.querySelectorAll('.content section').forEach(section => {
      section.classList.remove('active-section');
      section.style.display = 'none';
    });
    const home = document.getElementById('home');
    if (home) {
      home.classList.add('active-section');
      home.style.display = '';
    }
    // Set nav active state
    const navLinks = document.getElementById('nav-links');
    if (navLinks) {
      navLinks.querySelectorAll('a').forEach(link => {
        if (link.getAttribute('data-section') === 'home') link.classList.add('active');
        else link.classList.remove('active');
  
      });
    }
    // Accessibility toolbar theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    function setTheme(mode) {
      if (mode === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
        themeToggle.textContent = '☀️';
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.setAttribute('data-theme', 'dark');
        themeToggle.textContent = '🌙';
        localStorage.setItem('theme', 'dark');
      }
      console.log('Theme set to', mode);
    }
    // Detect system preference
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem('theme');
    setTheme(savedTheme || (prefersDark ? 'dark' : 'light'));
    themeToggle.onclick = () => {
      const current = localStorage.getItem('theme') || (prefersDark ? 'dark' : 'light');
      setTheme(current === 'dark' ? 'light' : 'dark');
    };
    // Fallback: ensure accessibility toolbar is always visible
    setTimeout(() => {
      const acc = document.getElementById('accessibility-toolbar');
      if (acc && (acc.style.display === 'none' || window.getComputedStyle(acc).display === 'none')) {
        acc.style.display = 'flex';
      }
    }, 100);
  });

  // Make lightning less intense
  const lightningEffect = document.querySelector('.lightning-effect');
  if (lightningEffect) lightningEffect.style.opacity = '0.08';
  const bolts = document.querySelectorAll('.lightning-bolt');
  bolts.forEach(bolt => {
    bolt.style.opacity = '0.07';
  });

  // Randomize bolt animation delays
  bolts.forEach((bolt,i)=>{
    bolt.style.animationDelay = (Math.random()*12+6*i)+'s';
  });

  // Interactive particles: repel from mouse, click = burst
  if(window.pJSDom&&window.pJSDom[0]){
    const pJS = window.pJSDom[0].pJS;
    pJS.interactivity.events.onhover.mode = 'repulse';
    pJS.interactivity.events.onclick.mode = 'push';
    pJS.interactivity.modes.repulse.distance = 180;
    pJS.interactivity.modes.push.particles_nb = 12;
  }

  // Steam-style Achievements
  let achievementsEnabled = localStorage.getItem('achievementsEnabled') !== 'false';
  const achievementsToggle = document.getElementById('achievements-toggle');
  if (achievementsToggle) {
    achievementsToggle.checked = achievementsEnabled;
    achievementsToggle.addEventListener('change', () => {
      achievementsEnabled = achievementsToggle.checked;
      localStorage.setItem('achievementsEnabled', achievementsEnabled);
      renderAchievements();
    });
  }
  function unlockAchievement(id) {
    if (!achievementsEnabled) return;
    const a = achievementsData.find(a => a.id === id);
    if (a && !a.unlocked) {
      a.unlocked = true;
      renderAchievements();
      // Show popup if enabled
      if (achievementsEnabled) showAchievementPopup(a);
    }
  }
  function renderAchievements() {
    const list = document.getElementById('achievements-list');
    if (!list) return;
    list.innerHTML = '';
    achievementsData.forEach(a => {
      const card = document.createElement('div');
      card.className = 'achievement-card';
      card.style.background = a.unlocked ? 'rgba(56,189,248,0.15)' : 'rgba(30,41,59,0.7)';
      card.style.border = a.unlocked ? '2px solid #38bdf8' : '2px solid #334155';
      card.style.borderRadius = '1rem';
      card.style.padding = '1.2rem';
      card.style.display = 'flex';
      card.style.alignItems = 'center';
      card.style.gap = '1.2rem';
      card.style.opacity = a.unlocked ? '1' : '0.5';
      card.innerHTML = `<span style="font-size:2.5rem;">${a.unlocked ? a.icon : '❔'}</span>
        <div><div style="font-size:1.2rem;font-weight:bold;color:#38bdf8;">${a.name}</div>
        <div style="color:#f1f5f9;">${a.desc}</div></div>`;
      list.appendChild(card);
    });
  }

  // Ensure launchGame function is present and global
  function launchGame(game) {
    let modal = document.createElement('div');
    modal.style.position = 'fixed';
    modal.style.top = '0';
    modal.style.left = '0';
    modal.style.width = '100vw';
    modal.style.height = '100vh';
    modal.style.background = 'rgba(10,20,40,0.92)';
    modal.style.zIndex = '10000';
    modal.style.display = 'flex';
    modal.style.flexDirection = 'column';
    modal.style.alignItems = 'center';
    modal.style.justifyContent = 'center';
    // Music URLs (public domain/CC0)
    const musicTracks = {
      'surge-maze': 'https://cdn.pixabay.com/audio/2022/10/16/audio_12b6b9b6b2.mp3',
      'pacman': 'https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae7c7.mp3',
      'robot-builder': 'https://cdn.pixabay.com/audio/2022/10/16/audio_12b6b9b6b2.mp3',
      'memory-circuit': 'https://cdn.pixabay.com/audio/2022/03/15/audio_115b9b7b7b.mp3',
    };
    let music = document.createElement('audio');
    music.src = musicTracks[game] || '';
    music.loop = true;
    music.volume = 0.25;
    music.autoplay = true;
    music.style.display = 'none';
    modal.appendChild(music);
    let isMuted = false;
    // Mute/unmute button
    let muteBtn = document.createElement('button');
    muteBtn.innerHTML = '🔊';
    muteBtn.title = 'Mute/Unmute Music';
    muteBtn.style.position = 'absolute';
    muteBtn.style.top = '2rem';
    muteBtn.style.left = '2rem';
    muteBtn.style.background = '#222';
    muteBtn.style.color = '#fff';
    muteBtn.style.fontSize = '1.5rem';
    muteBtn.style.padding = '0.5rem 1.2rem';
    muteBtn.style.border = 'none';
    muteBtn.style.borderRadius = '0.7rem';
    muteBtn.style.cursor = 'pointer';
    muteBtn.style.zIndex = '10001';
    muteBtn.onclick = () => {
      isMuted = !isMuted;
      music.muted = isMuted;
      muteBtn.innerHTML = isMuted ? '🔇' : '🔊';
    };
    modal.appendChild(muteBtn);
    // Close button
    modal.innerHTML += `<button onclick="this.parentElement.remove();window.__activeGameCleanup&&window.__activeGameCleanup();" style="position:absolute;top:2rem;right:2rem;background:#222;color:#fff;font-size:1.5rem;padding:0.5rem 1.2rem;border:none;border-radius:0.7rem;cursor:pointer;z-index:10001;">✕</button>`;
    let container = document.createElement('div');
    container.style.background = 'rgba(30,41,59,0.98)';
    container.style.padding = '2rem';
    container.style.borderRadius = '1.5rem';
    container.style.boxShadow = '0 8px 32px #000';
    container.style.display = 'flex';
    container.style.flexDirection = 'column';
    container.style.alignItems = 'center';
    container.style.justifyContent = 'center';
    container.style.minWidth = '320px';
    container.style.minHeight = '320px';
    container.style.maxWidth = '90vw';
    container.style.maxHeight = '80vh';
    container.style.overflow = 'auto';
    // INSTANT BOOT for surge-maze and pacman
    if (game === 'surge-maze') {
      container.innerHTML = `<h2 style='color:#38bdf8'>Surge Maze Game</h2><div id='surge-maze-modal'></div>`;
      modal.appendChild(container);
      document.body.appendChild(modal);
      if (window.__activeGameCleanup) window.__activeGameCleanup();
      window.__activeGameCleanup = () => { try { music.pause(); music.src = ''; } catch(e){} };
      setTimeout(() => startPacmanGameHD(document.getElementById('surge-maze-modal')), 0);
      window.__activeGameCleanup = () => {
        let c = document.getElementById('surge-maze-canvas');
        if (c) c.remove();
        try { music.pause(); music.src = ''; } catch(e){}
      };
      return;
    } else if (game === 'pacman') {
      container.innerHTML = `<h2 style='color:#fbbf24'>Pac-Man: Surge Edition</h2><div id='pacman-modal'></div>`;
      modal.appendChild(container);
      document.body.appendChild(modal);
      if (window.__activeGameCleanup) window.__activeGameCleanup();
      window.__activeGameCleanup = () => { try { music.pause(); music.src = ''; } catch(e){} };
      setTimeout(() => startPacmanGameHD(document.getElementById('pacman-modal')), 0);
      window.__activeGameCleanup = () => {
        let c = document.getElementById('surge-maze-canvas');
        if (c) c.remove();
        try { music.pause(); music.src = ''; } catch(e){}
      };
      return;
    }
    // For other games, show spinner and delay
    container.innerHTML = `<div id='game-loading-spinner' style='color:#38bdf8;font-size:2rem;text-align:center;'><svg width='48' height='48' viewBox='0 0 48 48' style='margin-bottom:1rem;'><circle cx='24' cy='24' r='20' stroke='#38bdf8' stroke-width='4' fill='none' stroke-dasharray='31.4 31.4' stroke-linecap='round'><animateTransform attributeName='transform' type='rotate' from='0 24 24' to='360 24 24' dur='1s' repeatCount='indefinite'/></circle></svg><div>Loading...</div></div>`;
    modal.appendChild(container);
    document.body.appendChild(modal);
    if (window.__activeGameCleanup) window.__activeGameCleanup();
    window.__activeGameCleanup = () => { try { music.pause(); music.src = ''; } catch(e){} };
    setTimeout(() => {
      window.__activeGameCleanup = () => { try { music.pause(); music.src = ''; } catch(e){} };
      if (game === 'robot-builder') {
        container.innerHTML = `<h2 style='color:#7c3aed'>Robot Builder</h2><div id='robot-builder-modal'></div>`;
        setTimeout(() => {
          startRobotBuilderGame(document.getElementById('robot-builder-modal'));
          window.__activeGameCleanup = () => {
            let c = document.getElementById('robot-builder-canvas');
            if (c) c.remove();
            try { music.pause(); music.src = ''; } catch(e){}
          };
        }, 50);
      } else if (game === 'memory-circuit') {
        container.innerHTML = `<h2 style='color:#0ea5e9'>Memory Circuit</h2><div id='memory-circuit-modal'></div>`;
        setTimeout(() => {
          startMemoryCircuitGame(document.getElementById('memory-circuit-modal'));
          window.__activeGameCleanup = () => {
            let c = document.getElementById('memory-circuit-canvas');
            if (c) c.remove();
            try { music.pause(); music.src = ''; } catch(e){}
          };
        }, 50);
      }
    }, 10);
  }
  // Lightweight Robot Builder game
  function startRobotBuilderGame(container) {
    container.innerHTML = `<canvas id='robot-builder-canvas' width='400' height='320' style='background:#181f2e;border-radius:1rem;box-shadow:0 0 24px #7c3aed;width:100%;max-width:400px;max-height:60vw;outline:none;'></canvas><div style='color:#fff;margin-top:1rem;'>Drag the parts to build your robot!</div>`;
    const canvas = container.querySelector('#robot-builder-canvas');
    const ctx = canvas.getContext('2d');
    // Simple drag-and-drop robot parts
    const parts = [
      {x:40,y:220,w:60,h:60,color:'#38bdf8',drag:false}, // body
      {x:60,y:120,w:20,h:60,color:'#7c3aed',drag:false}, // head
      {x:20,y:250,w:20,h:40,color:'#fbbf24',drag:false}, // left leg
      {x:100,y:250,w:20,h:40,color:'#fbbf24',drag:false}, // right leg
      {x:20,y:180,w:20,h:40,color:'#0ea5e9',drag:false}, // left arm
      {x:100,y:180,w:20,h:40,color:'#0ea5e9',drag:false}, // right arm
    ];
    let dragging = null, offsetX=0, offsetY=0;
    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(const p of parts) {
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x,p.y,p.w,p.h);
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.strokeRect(p.x,p.y,p.w,p.h);
      }
    }
    draw();
    canvas.onmousedown = e => {
      const rect = canvas.getBoundingClientRect();
      const mx = e.clientX - rect.left, my = e.clientY - rect.top;
      for(let i=parts.length-1;i>=0;i--) {
        const p = parts[i];
        if(mx>=p.x&&mx<=p.x+p.w&&my>=p.y&&my<=p.y+p.h) {
          dragging = p; offsetX=mx-p.x; offsetY=my-p.y; break;
        }
      }
    };
    canvas.onmousemove = e => {
      if(dragging) {
        const rect = canvas.getBoundingClientRect();
        dragging.x = e.clientX-rect.left-offsetX;
        dragging.y = e.clientY-rect.top-offsetY;
        draw();
      }
    };
    canvas.onmouseup = () => { dragging=null; };
    canvas.onmouseleave = () => { dragging=null; };
  }
  // Lightweight Memory Circuit game
  function startMemoryCircuitGame(container) {
    container.innerHTML = `<canvas id='memory-circuit-canvas' width='400' height='320' style='background:#181f2e;border-radius:1rem;box-shadow:0 0 24px #0ea5e9;width:100%;max-width:400px;max-height:60vw;outline:none;'></canvas><div style='color:#fff;margin-top:1rem;'>Flip the cards to match all pairs!</div>`;
    const canvas = container.querySelector('#memory-circuit-canvas');
    const ctx = canvas.getContext('2d');
    const cols=4, rows=3, total=cols*rows;
    let values = Array.from({length:total/2},(_,i)=>i+1).flatMap(x=>[x,x]);
    values = values.sort(()=>Math.random()-0.5);
    let cards = values.map((v,i)=>({v,flipped:false,found:false}));
    let first=null, second=null, lock=false;
    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let i=0;i<total;i++) {
        const x = (i%cols)*90+20, y = Math.floor(i/cols)*90+20;
        ctx.save();
        ctx.translate(x,y);
        ctx.strokeStyle = '#fff';
        ctx.lineWidth = 2;
        ctx.strokeRect(0,0,60,60);
        if(cards[i].flipped||cards[i].found) {
          ctx.fillStyle = '#7c3aed';
          ctx.fillRect(0,0,60,60);
          ctx.fillStyle = '#fff';
          ctx.font = 'bold 2rem Orbitron, sans-serif';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText(cards[i].v,30,32);
        } else {
          ctx.fillStyle = '#222';
          ctx.fillRect(0,0,60,60);
        }
        ctx.restore();
      }
    }
    draw();
    canvas.onclick = e => {
      if(lock) return;
      const rect = canvas.getBoundingClientRect();
      const mx = e.clientX-rect.left, my = e.clientY-rect.top;
      for(let i=0;i<total;i++) {
        const x = (i%cols)*90+20, y = Math.floor(i/cols)*90+20;
        if(mx>=x&&mx<=x+60&&my>=y&&my<=y+60&&!cards[i].flipped&&!cards[i].found) {
          if(!first) { cards[i].flipped=true; first=i; }
          else if(!second) { cards[i].flipped=true; second=i; lock=true; setTimeout(()=>{
            if(cards[first].v===cards[second].v) { cards[first].found=cards[second].found=true; }
            else { cards[first].flipped=cards[second].flipped=false; }
            first=second=null; lock=false; draw();
          },700); }
          draw();
          break;
        }
      }
    };
  }

  // --- Achievements Data and Popup ---
  const achievementsData = [
    { id: 'firstClick', name: 'First Click!', desc: 'You clicked Surge for the first time.', icon: '👆', unlocked: false },
    { id: 'tenClicks', name: 'Click Master', desc: 'You clicked Surge 10 times!', icon: '🔟', unlocked: false },
    { id: 'playMaze', name: 'Maze Runner', desc: 'You played Surge Maze.', icon: '🌀', unlocked: false },
    { id: 'playPacman', name: 'Pac-Maniac', desc: 'You played Pac-Man: Surge Edition.', icon: '🟡', unlocked: false },
    { id: 'builder', name: 'Robot Builder', desc: 'You built a robot in Robot Builder.', icon: '🤖', unlocked: false },
    { id: 'memory', name: 'Circuit Memory', desc: 'You played Memory Circuit.', icon: '💾', unlocked: false },
    { id: 'themeSwitch', name: 'Theme Switcher', desc: 'You toggled the site theme.', icon: '🌓', unlocked: false },
  ];
  function showAchievementPopup(a) {
    const popup = document.createElement('div');
    popup.style.position = 'fixed';
    popup.style.bottom = '40px';
    popup.style.right = '40px';
    popup.style.background = 'rgba(30,41,59,0.97)';
    popup.style.color = '#38bdf8';
    popup.style.padding = '1.2rem 2rem';
    popup.style.borderRadius = '1.2rem';
    popup.style.boxShadow = '0 2px 12px #38bdf8';
    popup.style.fontFamily = 'Orbitron, sans-serif';
    popup.style.fontSize = '1.2rem';
    popup.style.zIndex = '10003';
    popup.style.display = 'flex';
    popup.style.alignItems = 'center';
    popup.style.gap = '1.2rem';
    popup.innerHTML = `<span style="font-size:2.5rem;">${a.icon}</span> <span><b>${a.name}</b><br><span style='font-size:1rem;color:#f1f5f9;'>${a.desc}</span></span>`;
    document.body.appendChild(popup);
    setTimeout(() => { popup.style.opacity = '0'; popup.style.transition = 'opacity 0.7s'; }, 2200);
    setTimeout(() => { popup.remove(); }, 3000);
  }

  document.addEventListener('DOMContentLoaded', () => {
    // ... existing code ...
    // Sponsors
    document.querySelectorAll('.sponsors-grid img').forEach((img, i) => {
      const unsplash = [
        'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80',
        'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80',
        'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80',
        'https://images.unsplash.com/photo-1521737852567-6949f3f9f2b5?auto=format&fit=crop&w=400&q=80',
      ];
      img.src = unsplash[i % unsplash.length];
    });
    // Pit tour images
    const pitImgs = document.querySelectorAll('#pit-tour-grid img');
    const pitUnsplash = [
      'https://images.unsplash.com/photo-1517694712202-14dd9538aa97?auto=format&fit=crop&w=400&q=80', // Robot
      'https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80', // Field
      'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=400&q=80', // Team Station
    ];
    pitImgs.forEach((img, i) => { img.src = pitUnsplash[i % pitUnsplash.length]; });
  });
  </script>
</body>
</html>
